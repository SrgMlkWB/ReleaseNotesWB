<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-translate="title">Release Notes - WINBACK</title>
    <link rel="icon" href="img/LogoWBrond.png" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav>
      <div class="nav-container">
        <!-- Burger menu déplacé en premier -->
        <div class="burger-menu" id="burger-menu">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <!-- Logo déplacé après -->
        <object
          id="winback-logo"
          data="img/logoWB.svg"
          type="image/svg+xml"
        ></object>
      </div>
      <div class="nav-controls">
        <!-- Suppression du bloc search-container -->
        <div class="theme-toggle">
          <label for="toggle" class="switch">
            <span class="switch-label"></span>
            <input type="checkbox" id="toggle" aria-label="Toggle dark mode" />
            <span class="slider"></span>
          </label>
        </div>
      </div>
    </nav>

    <header>
      <h2 data-translate="main-title">Release Notes</h2>
      <!-- Suppression de la div slideshow-container et slideshow-image -->
      <div class="disclaimer-top">
        <div class="disclaimer" id="disclaimer">
          <div class="disclaimer-content">
            <div class="language-selector">
              <label for="language-select" class="visually-hidden"
                >Select language</label
              >
              <select id="language-select" aria-label="Select language">
                <option value="en" data-flag="gb"></option>
                <option value="fr" data-flag="fr"></option>
                <option value="de" data-flag="de"></option>
                <option value="nl" data-flag="nl"></option>
                <option value="el" data-flag="gr"></option>
                <option value="hu" data-flag="hu"></option>
                <option value="it" data-flag="it"></option>
                <option value="pl" data-flag="pl"></option>
                <option value="pt" data-flag="pt"></option>
                <option value="es" data-flag="es"></option>
                <option value="sv" data-flag="se"></option>
                <option value="tr" data-flag="tr"></option>
              </select>
              <img src="img/Arrow.png" alt="arrow" class="lang-arrow" />
            </div>
            <span>
              <span data-translate="disclaimer_text_start"></span>
              <a
                href="tel:+33483661666"
                class="contact-link"
                data-translate="phone"
              ></a>
              <span data-translate="disclaimer_text_middle"></span>
              <a
                href="mailto:hello@winback.com"
                class="contact-link"
                data-translate="email"
              ></a>
            </span>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="sidebar hidden" id="sidebar">
        <ul>
          <li>
            <a href="#version46">
              Version 4.6
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version43">
              Version 4.3
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version42">
              Version 4.2
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version339">
              Version 3.39
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version334">
              Version 3.34
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version333">
              Version 3.33
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version327">
              Version 3.27
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version320">
              Version 3.20
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version317">
              Version 3.17
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
          <li>
            <a href="#version314">
              Version 3.14
              <img src="img/Arrow.png" alt="Flèche" class="side-arrow-icon" />
            </a>
          </li>
        </ul>
      </div>

      <div class="content">
        <div class="version-container" id="version-container">
          <!-- Les versions seront générées ici dynamiquement -->
        </div>
      </div>
    </main>

    <script type="module">
      import { updateVersionDisplay } from "./js/versionDisplay.js";
      import translations from "./js/translations.js";

      const toggle = document.getElementById("toggle");
      const body = document.body;
      const winbackLogo = document.getElementById("winback-logo");
      const burgerMenu = document.getElementById("burger-menu");
      const sidebar = document.getElementById("sidebar");

      // Fonction pour fermer la sidebar
      function closeSidebar() {
        burgerMenu.classList.remove("active");
        sidebar.classList.add("hidden");
        sidebar.classList.remove("visible");
        body.classList.remove("sidebar-open");
      }

      // Mode sombre
      const darkMode = localStorage.getItem("darkMode");
      if (darkMode === "enabled") {
        body.classList.add("dark-mode");
        toggle.checked = true;
        updateLogoColor(true);
      }

      function updateLogoColor(isDark) {
        if (winbackLogo && winbackLogo.contentDocument) {
          const paths = winbackLogo.contentDocument.querySelectorAll("path");
          paths.forEach((path) => {
            if (path.getAttribute("fill") !== "#F18841") {
              path.style.fill = isDark ? "#FFFFFF" : "#000000";
            }
          });
        }
      }

      // Gestionnaire d'événement pour le switch
      toggle.addEventListener("change", () => {
        if (toggle.checked) {
          body.classList.add("dark-mode");
          localStorage.setItem("darkMode", "enabled");
          updateLogoColor(true);
        } else {
          body.classList.remove("dark-mode");
          localStorage.setItem("darkMode", "disabled");
          updateLogoColor(false);
        }
      });

      // Mettre à jour la couleur du logo quand il est chargé
      winbackLogo.addEventListener("load", function () {
        updateLogoColor(body.classList.contains("dark-mode"));
      });

      // Menu burger
      burgerMenu.addEventListener("click", () => {
        burgerMenu.classList.toggle("active");
        sidebar.classList.toggle("hidden");
        sidebar.classList.toggle("visible");
        body.classList.toggle("sidebar-open");
      });

      // Initialiser la sidebar
      function initializeSidebar() {
        if (window.innerWidth <= 768) {
          sidebar.classList.add("hidden");
          sidebar.classList.remove("visible");
          body.classList.remove("sidebar-open");
        } else {
          sidebar.classList.remove("hidden");
          sidebar.classList.add("visible");
          body.classList.add("sidebar-open");
        }
      }

      window.addEventListener("load", initializeSidebar);
      window.addEventListener("resize", initializeSidebar);

      // Détails des versions
      document.querySelectorAll(".version h2").forEach((header) => {
        header.addEventListener("click", function () {
          const details = this.nextElementSibling.nextElementSibling;
          const arrow = this.querySelector(".arrow-icon");
          details.classList.toggle("show");
          arrow.style.transform = details.classList.contains("show");
          // ? "rotate(90deg)"
          // : "rotate(0deg)";
        });
      });

      // Supprimer les event listeners pour la recherche

      // Gestion de la langue
      function updateLanguage(lang) {
        // Vérifier si la langue existe dans les traductions
        if (!translations[lang]) {
          console.warn(`Language ${lang} not found in translations`);
          lang = "en"; // Fallback to English
        }

        // Mettre à jour tous les éléments avec data-translate dans tout le document
        const elementsToTranslate =
          document.querySelectorAll("[data-translate]");

        elementsToTranslate.forEach((element) => {
          const key = element.getAttribute("data-translate");

          // Vérifier si la clé existe dans les traductions
          if (translations[lang][key]) {
            // Gérer les différents types d'éléments
            if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
              // Pour les champs de saisie, mettre à jour le placeholder
              element.placeholder = translations[lang][key];
            } else if (element.tagName === "META") {
              // Pour les balises meta, mettre à jour le contenu
              element.content = translations[lang][key];
            } else {
              // Pour les autres éléments, mettre à jour le texte
              element.textContent = translations[lang][key];
            }
          } else {
            console.warn(
              `Translation key "${key}" not found for language ${lang}`
            );
          }
        });

        // Mettre à jour la langue du document
        document.documentElement.lang = lang;

        // Mettre à jour le sélecteur de langue
        const languageSelect = document.getElementById("language-select");
        if (languageSelect) {
          languageSelect.value = lang;
        }

        // Sauvegarder la préférence de langue
        localStorage.setItem("selectedLanguage", lang);
      }

      // Initialisation de la langue
      function initializeLanguage() {
        // Toujours utiliser l'anglais comme langue par défaut
        const initialLang = "en";

        // Mettre à jour l'interface avec la langue initiale
        updateLanguage(initialLang);
      }

      // Configuration des écouteurs d'événements
      document.addEventListener("DOMContentLoaded", () => {
        const languageSelect = document.getElementById("language-select");

        if (languageSelect) {
          languageSelect.addEventListener("change", (e) => {
            updateLanguage(e.target.value);
          });
        }

        // Initialiser la langue
        initializeLanguage();
      });

      // Supprimer les event listeners pour le close disclaimer
    </script>
    <script>
      const languageSelector = document.querySelector(".language-selector");
      const languageSelect = document.getElementById("language-select");
      const langArrow = document.querySelector(".lang-arrow");

      // Fonction pour basculer l'état du sélecteur
      function toggleLanguageSelector() {
        languageSelector.classList.toggle("active");
      }

      // Event listener pour le select
      languageSelect.addEventListener("click", toggleLanguageSelector);

      // Event listener pour la flèche
      langArrow.addEventListener("click", () => {
        languageSelect.click(); // Simule un clic sur le select
      });

      // Fermer le sélecteur quand une option est sélectionnée
      languageSelect.addEventListener("change", () => {
        languageSelector.classList.remove("active");
      });

      // Fermer le sélecteur quand on clique ailleurs sur la page
      document.addEventListener("click", (event) => {
        if (!languageSelector.contains(event.target)) {
          languageSelector.classList.remove("active");
        }
      });

      // Ajouter après les autres event listeners
      document.addEventListener("click", (event) => {
        // Vérifie si le clic est en dehors de la sidebar et du burger menu
        if (
          !sidebar.contains(event.target) &&
          !burgerMenu.contains(event.target) &&
          sidebar.classList.contains("visible")
        ) {
          closeSidebar();
        }
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const languageSelect = document.querySelector(
          ".language-selector select"
        );
        const languageSelector = document.querySelector(".language-selector");

        function updateFlag(select) {
          const selectedOption = select.options[select.selectedIndex];
          const flagCode = selectedOption.getAttribute("data-flag");
          const flagUrl = `https://flagicons.lipis.dev/flags/4x3/${flagCode}.svg`;
          languageSelector.style.setProperty("--flag-url", `url(${flagUrl})`);
        }

        // Mettre à jour le drapeau initialement
        updateFlag(languageSelect);

        // Mettre à jour le drapeau quand la sélection change
        languageSelect.addEventListener("change", function () {
          updateFlag(this);
        });
      });
    </script>
    <!-- Suppression du script de slideshow en bas du fichier -->
    <!--
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const images = document.querySelectorAll(".slideshow-image");
        let currentImageIndex = 0;

        function nextImage() {
          images[currentImageIndex].classList.remove("active");
          currentImageIndex = (currentImageIndex + 1) % images.length;
          images[currentImageIndex].classList.add("active");
        }

        setInterval(nextImage, 5000);
      });
    </script>
    -->
  </body>
</html>
